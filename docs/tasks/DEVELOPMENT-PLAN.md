# Proposal-Copilot 完整开发计划

## 项目概述

Proposal-Copilot 是一个桌面应用程序，旨在帮助系统集成（SI）行业的项目经理和售前工程师，通过自然语言对话将非结构化需求转换为标准化的结构化文档（Word/PDF 提案和 Excel 报价单）。

**核心原则：**

- **本地优先**：所有数据存储在用户机器上，保护隐私
- **对话即建模**：聊天界面直接构建项目数据模型
- **无代码模板**：AI 模仿参考文档样式，而非硬编码占位符替换

## 技术栈

- **前端/外壳**：Electron + Svelte + TypeScript
- **后端/引擎**：Node.js（Electron Main 进程）
- **存储**：文件系统持久化（每个项目为包含 `project.json` 的文件夹）
- **AI 集成**：支持 OpenAI、DeepSeek、本地 Ollama

## 开发阶段规划

### 阶段 1：核心基础设施（已完成 60%）

**目标**：建立稳定的基础框架和核心数据模型
**预计时间**：2-3 周

#### 已完成：

- ✅ 项目创建/打开功能
- ✅ 基础界面框架（Workbench、Tab 系统）
- ✅ 设置系统（LLM 提供商配置）
- ✅ 项目数据模型定义（`project.json` 结构）
- ✅ 基础聊天界面（SplitPane 布局）

#### 待完成：

- [ ] 项目树可视化组件（Tree View）
- [ ] 实时预览组件增强
- [ ] 项目自动保存机制
- [ ] 数据验证和迁移支持

### 阶段 2：AI 对话引擎

**目标**：实现智能对话建模功能
**预计时间**：3-4 周

#### 核心功能：

- [ ] LLM 集成（OpenAI、DeepSeek、Ollama）
- [ ] 对话到项目树的转换逻辑
- [ ] 主动提问机制（技术参数缺失时）
- [ ] 上下文管理和记忆
- [ ] 流式响应支持

#### 技术要求：

- 支持多轮对话
- 项目状态实时更新
- 错误处理和重试机制
- 令牌使用优化

### 阶段 3：文档生成引擎

**目标**：实现专业文档生成功能
**预计时间**：4-5 周

#### Word/PDF 导出：

- [ ] 参考文档解析（样式提取）
- [ ] AI 内容生成（基于项目数据）
- [ ] 内容注入和格式化
- [ ] 模板管理系统

#### Excel 导出：

- [ ] BOM（物料清单）扁平化
- [ ] 公式和计算支持
- [ ] 格式化和样式
- [ ] 多工作表支持

### 阶段 4：高级功能

**目标**：增强用户体验和生产力
**预计时间**：3-4 周

#### 功能列表：

- [ ] 文件上传和 RAG（检索增强生成）
- [ ] 多项目管理
- [ ] 导出模板库
- [ ] 协作功能（评论、批注）
- [ ] 历史版本管理
- [ ] 批量操作

### 阶段 5：优化和发布

**目标**：性能优化、测试和发布准备
**预计时间**：2-3 周

#### 任务：

- [ ] 性能优化（大型项目处理）
- [ ] 单元测试和集成测试
- [ ] 用户文档和教程
- [ ] 多平台打包（Windows、macOS、Linux）
- [ ] 自动更新机制
- [ ] 错误报告和日志

## 里程碑

### 里程碑 1：MVP 版本（阶段 1 + 2 核心）

**目标**：基本可用的对话建模工具
**功能**：

- 创建/打开项目
- 基础聊天界面
- LLM 集成（至少一个提供商）
- 项目树实时更新
- 基础 Markdown 预览

### 里程碑 2：文档生成版本（阶段 3 核心）

**目标**：完整的提案生成工作流
**功能**：

- Word/PDF 导出
- Excel 报价单导出
- 参考文档模板支持
- 格式化控制

### 里程碑 3：生产就绪版本（阶段 4 + 5）

**目标**：企业级可用工具
**功能**：

- 所有核心功能
- 性能优化
- 完整测试覆盖
- 多平台支持
- 用户文档

## 技术架构要点

### 数据流设计

```
用户对话 → AI 处理 → 项目树更新 → 实时预览 → 文档生成
```

### 关键组件

1. **Workbench**：主界面，管理标签和视图切换
2. **ChatPanel**：对话界面，处理用户输入和 AI 响应
3. **TreeView**：项目结构可视化，支持 CRUD 操作
4. **PreviewPane**：实时文档预览
5. **ProjectStore**：项目状态管理
6. **DocumentEngine**：文档生成引擎
7. **AIService**：LLM 集成服务

### 性能考虑

- 大型项目树的渲染优化
- 文档生成的异步处理
- 内存管理（项目切换时的清理）
- 文件 I/O 性能

## 风险与缓解

### 技术风险

1. **LLM API 稳定性**：多提供商支持，本地回退选项
2. **文档生成质量**：渐进式改进，用户反馈循环
3. **性能问题**：代码分割、懒加载、优化算法

### 项目风险

1. **范围蔓延**：严格遵循 MVP 优先原则
2. **时间估计**：缓冲时间，优先级排序
3. **质量保证**：自动化测试，代码审查

## 成功指标

### 功能指标

- [ ] 支持至少 3 种 LLM 提供商
- [ ] 文档生成时间 < 30 秒（中等规模项目）
- [ ] 项目加载时间 < 5 秒
- [ ] 内存使用 < 500MB（典型使用）

### 用户体验指标

- [ ] 用户完成完整工作流时间 < 10 分钟
- [ ] 错误率 < 1%
- [ ] 用户满意度评分 > 4/5

## 下一步行动

1. **立即开始**：阶段 1 剩余任务
2. **并行准备**：阶段 2 的技术调研
3. **用户测试**：MVP 版本的早期反馈收集
4. **迭代开发**：基于反馈的优先级调整

---

_最后更新：2026-01-14_
_版本：v1.0_
